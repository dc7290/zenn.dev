---
title: "microCMSã®ãƒªãƒƒãƒã‚¨ãƒ‡ã‚£ã‚¿ã§å–å¾—ã§ãã‚‹å€¤ã‚’ã€ã„ã„æ„Ÿã˜ã«å‡¦ç†ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ç´¹ä»‹"
emoji: "ğŸ´"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["microcms"]
published: false
---

# ã¯ã˜ã‚ã«

microCMS ã‚’ä½¿ã£ã¦ã„ã‚‹æ–¹ã¯ã”å­˜çŸ¥ã®é€šã‚Šã€
API ã‚¹ã‚­ãƒ¼ãƒè¨­å®šã®éš›ã«ç”¨ã„ã‚‹ã“ã¨ã®ã§ãã‚‹å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã¨ã—ã¦ã€ã€Œãƒªãƒƒãƒã‚¨ãƒ‡ã‚£ã‚¿ã€ãŒã‚ã‚Šã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/a7afdecafc0dace5471152dd.png)
ã“ã¡ã‚‰ã®ã‚ˆã†ã«æ§˜ã€…ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚ã‚‹ã‚¨ãƒ‡ã‚£ã‚¿ã«ãªã£ã¦ãŠã‚Šã€
ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ã¯ HTML ãŒè¿”ã£ã¦ãã¦ã€ã“ã‚Œã²ã¨ã¤ã§ã‚‚ã‹ãªã‚Šã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’ã‚«ãƒãƒ¼ã§ãã¾ã™ã€‚

ãŸã ã€åƒ•è‡ªèº«ã€å–å¾—ã—ãŸ HTML ãƒ‡ãƒ¼ã‚¿ã‚’ãã®ã¾ã¾ä½¿ã†ã“ã¨ã¯ã»ã¨ã‚“ã©ãªã
ã‚µãƒ¼ãƒãƒ¼ã§å‡¦ç†ã‚’ã—ãŸä¸Šã§ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ“ãƒ«ãƒ‰ã«å«ã‚ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚

ãã‚“ãªãµã†ã«ã€æ¯å›åŒã˜ã‚ˆã†ãªå‡¦ç†ã‚’æ›¸ã„ã¦ã„ã‚‹æ°—ãŒã—ãŸã®ã§ã€
ãã®å‡¦ç†ã‚’ã‚ã‚‹ç¨‹åº¦æ±ç”¨åŒ–ã—ã¦ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ä½œæˆã—ã€
å…¬é–‹ã‚’ã—ã¾ã—ãŸã®ã§ã€ãœã²ãŠä½¿ã„ãã ã•ã„ã€‚

https://www.npmjs.com/package/microcms-richedit-processer

# ç‰¹å¾´

ã©ã‚“ãªæ©Ÿèƒ½ãŒã‚ã‚‹ã®ã‹ç‰¹å¾´ã‚’åˆ—æŒ™ã—ã¦ã„ãã¾ã™ã€‚

## HTML ãƒ‡ãƒ¼ã‚¿ã®åŠ å·¥

- img ã‚¿ã‚°
  - é…å»¶èª­ã¿è¾¼ã¿(ç¾åœ¨ã€é…å»¶èª­ã¿è¾¼ã¿ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®`lazysizes`ã®ã‚¯ãƒ©ã‚¹åã‚’ã‚µãƒãƒ¼ãƒˆ)
  - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ç”»åƒã®ã‚µãƒãƒ¼ãƒˆ(srcSet, sizes å±æ€§ã«ã‚ˆã£ã¦ã‚¦ã‚¤ãƒ³ãƒ‰ã‚¦å¹…ã«åˆã‚ã›ã¦æœ€é©ãªç”»åƒã‚’é…ä¿¡ã™ã‚‹æŠ€è¡“)
  - placeholder ç”»åƒã®è¨­å®š
  - imgix ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¿½åŠ 
  - width, height å±æ€§ã®è‡ªå‹•è¨­å®š
  - ã‚¯ãƒ©ã‚¹åã®è¿½åŠ 
- iframe ã‚¿ã‚°
  - é…å»¶èª­ã¿è¾¼ã¿(ç¾åœ¨ã€é…å»¶èª­ã¿è¾¼ã¿ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®`lazysizes`ã®ã‚¯ãƒ©ã‚¹åã‚’ã‚µãƒãƒ¼ãƒˆ)
  - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ
  - ã‚¯ãƒ©ã‚¹åã®è¿½åŠ 
- pre ã‚¿ã‚°å†…ã® code ã‚¿ã‚°
  - ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆã®ãŸã‚ã«ã‚¯ãƒ©ã‚¹åã®è¿½åŠ (ç¾åœ¨ã€`highlight.js`ã‚’ã‚µãƒãƒ¼ãƒˆ)

## HTML ãƒ‡ãƒ¼ã‚¿ã‚’å…ƒã«åˆ¥ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ

- ç›®æ¬¡ãƒªã‚¹ãƒˆã®ä½œæˆ

# ä½¿ã„æ–¹

ã¾ãšã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```bash
npm i microcms-richedit-processer
# yarn add microcms-richedit-processer
```

ã“ã“ã§ã¯ Next.js ã‚’ä½¿ã£ã¦è§£èª¬ã—ã¾ã™ã€‚
ä»–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã¯é©å®œèª­ã¿æ›¿ãˆã¦ãã ã•ã„ã€‚

ãƒ“ãƒ«ãƒ‰æ™‚ã«å‡¦ç†ã—ãŸã„ã®ã§ã€`getStaticProps` ã‚’ä½¿ã„ã¾ã™ã€‚

```tsx
import { GetStaticProps, NextPage } from "next";

import { createTableOfContents, processer } from "microcms-richedit-processer";

type Props = {
  body: string;
  toc: {
    id: string;
    text: string;
    name: string;
  }[];
};

export const getStaticProps: GetStaticProps<Props> = async () => {
  const { contents } = await fetch(
    "https://{ã‚µãƒ¼ãƒ“ã‚¹ID}.microcms.io/api/v1/{ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ}",
    {
      headers: {
        "X-API-KEY": "{APIã‚­ãƒ¼}",
      },
    }
  ).then((res) => res.json());

  return {
    props: {
      body: await processer(contents.body),
      // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ¸¡ã™å ´åˆ
      // body: processer(contents.body, {}),
      toc: createTableOfContents(contents.body),
      // ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ¸¡ã™å ´åˆ
      // toc: createTableOfContents(contents.body, {}),
    },
  };
};
```

ï¼’ã¤ã®é–¢æ•°ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

`processer` ã¯ HTML ãƒ‡ãƒ¼ã‚¿ã®åŠ å·¥ã‚’æ‹…å½“ã—ã¾ã™ã€‚
`createTableOfContents` ã¯ç›®æ¬¡ãƒªã‚¹ãƒˆã®ä½œæˆã‚’æ‹…å½“ã—ã¾ã™ã€‚

ã“ã®ã‚ˆã†ã«å‡¦ç†ã—ãŸæ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã«ç”¨ã„ã‚Œã° OK ã§ã™ï¼

## å‹•ä½œã®è©³ç´°

ä»¥ä¸‹ã§ãã‚Œãã‚Œã®å‹•ä½œã‚’è§£èª¬ã—ã¾ã™ã€‚
ã¾ãŸã€æŒ‡å®šã§ãã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãªã©è©³ã—ã„ã“ã¨ã¯ README ã«æ›¸ã„ã¦ã„ã¾ã™ã®ã§ã€ãã¡ã‚‰ã‚’ã”å‚ç…§ãã ã•ã„ã€‚
https://github.com/dc7290/microcms-richedit-processer#readme

### processer ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œ(img ã‚¿ã‚°)

img ã‚¿ã‚°ã‹ã‚‰ç´¹ä»‹ã—ã¾ã™ã€‚
microCMS ã®ãƒªãƒƒãƒã‚¨ãƒ‡ã‚£ã‚¿ã§ç”»åƒã‚’ç™»éŒ²ã™ã‚‹ã¨æŒ‡å®šã‚’ã—ãªã„é™ã‚Šã¯ä»¥ä¸‹ã®ã‚ˆã†ãªå½¢ã§å‡ºåŠ›ã•ã‚Œã¾ã™ã€‚

```diff html
<img
-  src="https://sample.com/image.png"
   alt
+  data-src="https://sample.com/image.png?auto=format"
+  data-srcset="https://sample.com/image.png?auto=format&w=640 640w, https://sample.com/image.png?auto=format&w=750 750w, https://sample.com/image.png?auto=format&w=828 828w, https://sample.com/image.png?auto=format&w=1080 1080w, https://sample.com/image.png?auto=format&w=1200 1200w, https://sample.com/image.png?auto=format&w=1920 1920w, https://sample.com/image.png?auto=format&w=2048 2048w, https://sample.com/image.png?auto=format&w=3840 3840w"
+  data-sizes="100vw"
+  width="ç”»åƒã®æ¨ªå¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
+  height="ç”»åƒã®ç¸¦å¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
+  class="lazyload"
/>
```

ã¾ãŸã€ãƒªãƒƒãƒã‚¨ãƒ‡ã‚£ã‚¿ä¸Šã§ç”»åƒã‚µã‚¤ã‚ºãªã©ã‚’æŒ‡å®šã—ãŸå ´åˆã€width, height å±æ€§ã«ã¯ãã®å€¤ãŒè¨­å®šã•ã‚Œã¾ã™ã®ã§ã”å®‰å¿ƒãã ã•ã„ã€‚

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãŸæ™‚ã®å‹•ä½œ(img ã‚¿ã‚°)

#### deviceSizes (srcset ã‚’ç”Ÿæˆã™ã‚‹éš›ã«å‚ç…§ã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹ã‚µã‚¤ã‚º)

```js
processer(content, {
  img: { deviceSizes: [640, 1280], sizes: "(min-width: 640px) 1000px, 100vw" },
});
```

```diff html
<img
-  src="https://sample.com/image.png"
   alt
+  data-src="https://sample.com/image.png?auto=format"
+  data-srcset="https://sample.com/image.png?auto=format&w=640 640w, https://sample.com/image.png?auto=format&w=1280 1280w"
+  data-sizes="(min-width: 640px) 1000px, 100vw"
+  width="ç”»åƒã®æ¨ªå¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
+  height="ç”»åƒã®ç¸¦å¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
+  class="lazyload"
/>
```

#### imgix ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

microCMS ã§ã¯ç”»åƒã‚’å–å¾—ã™ã‚‹éš›ã« imgixAPI ã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚
ãã®éš›ã«æŒ‡å®šã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚

å†…éƒ¨çš„ã«`ts-imgix`ã‚’ä½¿ã£ã¦ã„ã¦ã€ã‚¨ãƒ‡ã‚£ã‚¿ã«ã‚ˆã‚‹ä¿ç®¡ãŒåŠ¹ãã®ã§ã€
typo ã®å±é™ºãŒã‹ãªã‚Šè–„ã„çŠ¶æ…‹ã§æŒ‡å®šã§ãã¾ã™ã€‚

```js
processer(content, { img: { parameters: { q: 50, w: 800, h: 600 } } });
```

```diff html
<img
-  src="https://sample.com/image.png"
  alt
+  width="800"
+  height="600"
+  data-src="https://sample.com/image.png?auto=format&w=800&h=600&q=50"
+  data-srcset="https://sample.com/image.png?auto=format&w=640&h=480&q=50 640w, https://sample.com/image.png?auto=format&w=750&h=563&q=50 750w, https://sample.com/image.png?auto=format&w=828&h=621&q=50 828w, https://sample.com/image.png?auto=format&w=1080&h=810&q=50 1080w, https://sample.com/image.png?auto=format&w=1200&h=900&q=50 1200w, https://sample.com/image.png?auto=format&w=1920&h=1440&q=50 1920w, https://sample.com/image.png?auto=format&w=2048&h=1536&q=50 2048w, https://sample.com/image.png?auto=format&w=3840&h=2880&q=50 3840w"
+  data-sizes="100vw"
+  class="lazyload"
/>
```

#### ã‚¯ãƒ©ã‚¹åã®è¿½åŠ 

```js
processer(content, { img: { addClassName: ["class01", "class02"] } });
```

```diff html
<img
-  src="https://sample.com/image.png"
   alt
+  width="ç”»åƒã®æ¨ªå¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
+  height="ç”»åƒã®ç¸¦å¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
+  class="class01 class02 lazyload"
+  data-src="https://sample.com/image.png?auto=format"
+  data-srcset="https://sample.com/image.png?auto=format&w=640 640w, https://sample.com/image.png?auto=format&w=750 750w, https://sample.com/image.png?auto=format&w=828 828w, https://sample.com/image.png?auto=format&w=1080 1080w, https://sample.com/image.png?auto=format&w=1200 1200w, https://sample.com/image.png?auto=format&w=1920 1920w, https://sample.com/image.png?auto=format&w=2048 2048w, https://sample.com/image.png?auto=format&w=3840 3840w"
+  data-sizes="100vw"
/>
```

#### ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ç”»åƒã®è¨­å®š

```js
processer(content, { img: { placeholder: true } });
```

```diff html
<img
-  src="https://sample.com/image.png"
+  src="https://sample.com/image.png?w=50&q=30"
   alt
+  width="ç”»åƒã®æ¨ªå¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
+  height="ç”»åƒã®ç¸¦å¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
+  data-src="https://sample.com/image.png?auto=format"
+  data-srcset="https://sample.com/image.png?auto=format&w=640 640w, https://sample.com/image.png?auto=format&w=750 750w, https://sample.com/image.png?auto=format&w=828 828w, https://sample.com/image.png?auto=format&w=1080 1080w, https://sample.com/image.png?auto=format&w=1200 1200w, https://sample.com/image.png?auto=format&w=1920 1920w, https://sample.com/image.png?auto=format&w=2048 2048w, https://sample.com/image.png?auto=format&w=3840 3840w"
+  data-sizes="100vw"
+  class="lazyload"
+  style="width: 100%"
/>'
```

#### é…å»¶èª­ã¿è¾¼ã¿ã®ç„¡åŠ¹åŒ–

```js
processer(content, { img: { lazy: false } });
```

å‡¦ç†å¾Œ

```diff html
<img
-  src="https://sample.com/image.png"
+  src="https://sample.com/image.png?auto=format"
+  srcset="https://sample.com/image.png?auto=format&w=640 640w, https://sample.com/image.png?auto=format&w=750 750w, https://sample.com/image.png?auto=format&w=828 828w, https://sample.com/image.png?auto=format&w=1080 1080w, https://sample.com/image.png?auto=format&w=1200 1200w, https://sample.com/image.png?auto=format&w=1920 1920w, https://sample.com/image.png?auto=format&w=2048 2048w, https://sample.com/image.png?auto=format&w=3840 3840w"
+  sizes="100vw"
   alt
+  width="ç”»åƒã®æ¨ªå¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
+  height="ç”»åƒã®ç¸¦å¹…ãŒè‡ªå‹•ã§å…¥ã‚Šã¾ã™"
/>
```

### processer ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œ(iframe ã‚¿ã‚°)

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ iframe ã® width ã¨ height ã«åŸºã¥ã„ã¦ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”ã‚’æ±ºå®šã—ã¦ã€è¦ªè¦ç´ ã®å¹…ã«åˆã‚ã›ã¦ã‚µã‚¤ã‚ºã‚’ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ã«ã—ã¾ã™ã€‚

```diff html
+ <div style="position: relative; padding-bottom: calc(480 / 854 * 100%);">
    <iframe
-    class="embedly-embed"
+    class="embedly-embed lazyload"
-    src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FO1bhZgkC4Gw%3Ffeature%3Doembed&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DO1bhZgkC4Gw&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FO1bhZgkC4Gw%2Fhqdefault.jpg&key=d640a20a3b02484e94b4b0a08440f627&type=text%2Fhtml&schema=youtube"
     width="854"
     height="480"
     scrolling="no"
     title="YouTube embed"
     frameborder="0"
     allow="autoplay; fullscreen"
     allowfullscreen="true"
+    data-src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FO1bhZgkC4Gw%3Ffeature%3Doembed&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DO1bhZgkC4Gw&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FO1bhZgkC4Gw%2Fhqdefault.jpg&key=d640a20a3b02484e94b4b0a08440f627&type=text%2Fhtml&schema=youtube"
+    style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;"
   ></iframe>
+ </div>
```

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãŸæ™‚ã®å‹•ä½œ(iframe ã‚¿ã‚°)

#### ã‚¯ãƒ©ã‚¹åã®è¿½åŠ 

```js
processer(content, { iframe: { addClassName: ["class01", "class02"] } });
```

```diff html
+ <div style="position: relative; padding-bottom: calc(480 / 854 * 100%);">
    <iframe
-    class="embedly-embed"
+    class="embedly-embed class01 class02 lazyload"
-    src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FO1bhZgkC4Gw%3Ffeature%3Doembed&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DO1bhZgkC4Gw&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FO1bhZgkC4Gw%2Fhqdefault.jpg&key=d640a20a3b02484e94b4b0a08440f627&type=text%2Fhtml&schema=youtube"
     width="854"
     height="480"
     scrolling="no"
     title="YouTube embed"
     frameborder="0"
     allow="autoplay; fullscreen"
     allowfullscreen="true"
+    data-src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FO1bhZgkC4Gw%3Ffeature%3Doembed&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DO1bhZgkC4Gw&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FO1bhZgkC4Gw%2Fhqdefault.jpg&key=d640a20a3b02484e94b4b0a08440f627&type=text%2Fhtml&schema=youtube"
+    style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;"
   ></iframe>
+ </div>
```

#### width, height ã®æŒ‡å®š

```js
processer(content, { iframe: { width: 960, height: 640 } });
```

```diff html
+ <div style="position: relative; padding-bottom: calc(640 / 960 * 100%);">
    <iframe
-    class="embedly-embed"
+    class="embedly-embed lazyload"
-    src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FO1bhZgkC4Gw%3Ffeature%3Doembed&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DO1bhZgkC4Gw&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FO1bhZgkC4Gw%2Fhqdefault.jpg&key=d640a20a3b02484e94b4b0a08440f627&type=text%2Fhtml&schema=youtube"
-    width="854"
+    width="960"
-    height="480"
+    height="640"
     scrolling="no"
     title="YouTube embed"
     frameborder="0"
     allow="autoplay; fullscreen"
     allowfullscreen="true"
+    data-src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FO1bhZgkC4Gw%3Ffeature%3Doembed&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DO1bhZgkC4Gw&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FO1bhZgkC4Gw%2Fhqdefault.jpg&key=d640a20a3b02484e94b4b0a08440f627&type=text%2Fhtml&schema=youtube"
+    style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;"
   ></iframe>
+ </div>
```

#### é…å»¶èª­ã¿è¾¼ã¿ã®ç„¡åŠ¹åŒ–

```js
processer(content, { iframe: { lazy: false } });
```

```diff html
+ <div style="position: relative; padding-bottom: calc(480 / 854 * 100%);">
    <iframe
     class="embedly-embed"
     src="https://cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Fwww.youtube.com%2Fembed%2FO1bhZgkC4Gw%3Ffeature%3Doembed&display_name=YouTube&url=https%3A%2F%2Fwww.youtube.com%2Fwatch%3Fv%3DO1bhZgkC4Gw&image=https%3A%2F%2Fi.ytimg.com%2Fvi%2FO1bhZgkC4Gw%2Fhqdefault.jpg&key=d640a20a3b02484e94b4b0a08440f627&type=text%2Fhtml&schema=youtube"
     width="854"
     height="480"
     scrolling="no"
     title="YouTube embed"
     frameborder="0"
     allow="autoplay; fullscreen"
     allowfullscreen="true"
+    style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;"
   ></iframe>
+ </div>
```

### processer ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œ(pre code ã‚¿ã‚°)

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã‚ªãƒ•ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚ªãƒ³ã«ã—ã¦ä½¿ç”¨ã§ãã¾ã™ã€‚
ã¾ãŸã€ãã®éš›ã¯ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ãƒã‚¤ãƒ©ã‚¤ãƒˆã«ç”¨ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’é©å®œã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
ï¼ˆç¾åœ¨ã¯ `highlight.js` ã®ã¿ï¼‰

```js
processer(content, { code: { enabled: true } });
```

```diff html
<pre>
   <code>
-  import { AppProps } from &#x27;next&#x2F;app&#x27;\n\nconst MyApp = ({ Component, pageProps }: AppProps): JSX.Element =&gt; {\n  return &lt;Component {...pageProps} &#x2F;&gt;\n}\n\nexport default MyApp
+  <span class="hljs-keyword">import</span> { AppProps } from <span class="hljs-string">&#x27;next/app&#x27;</span>\n\n<span class="hljs-keyword">const</span> MyApp = ({ Component, pageProps }: AppProps): JSX.<span class="hljs-built_in">Element</span> =&gt; {\n  <span class="hljs-keyword">return</span> &lt;Component {...pageProps} /&gt;\n}\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> MyApp
   </code>
</pre>
```

ã¾ãŸã€ãƒã‚¤ãƒ©ã‚¤ãƒˆã«ä½¿ã†ãƒ†ãƒ¼ãƒã® css ã¯ã”è‡ªèº«ã§ãƒãƒ³ãƒ‰ãƒ«ã—ã¦ãã ã•ã„ã€‚
ã”å‚è€ƒã¾ã§ã«ä¸€ä¾‹ã‚’è¨˜è¿°ã—ã¾ã™ã€‚

```tsx:index.tsx
import "highlight.js/styles/github-dark.css";

import { GetStaticProps, NextPage } from 'next'
import { processer } from "microcms-richedit-processer";

type Props = {
  body: string;
};

export const getStaticProps: GetStaticProps<Props> = async () => {
  const { contents } = await fetch(
    "https://{ã‚µãƒ¼ãƒ“ã‚¹ID}.microcms.io/api/v1/{ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ}",
    {
      headers: {
        "X-API-KEY": "{APIã‚­ãƒ¼}",
      },
    }
  ).then((res) => res.json());

  return {
    props: {
      body: await processer(contents.body, {
        code: { enabled: true }
      }),
    },
  };
};

const IndexPage: NextPage<Props> = ({ body }) => {
  return (
    <>
      <style global jsx>{`
      .content pre > code {
        display: block;
        padding: 1rem;
      }
      `}</style>
      <div className="content" dangerouslySetInnerHTML={{ __html: body }} />
    </>
  )
}
```

### createTableOfContents ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œ

ç›®æ¬¡ãƒªã‚¹ãƒˆã‚’ä½œæˆã™ã‚‹ `createTableOfContents` ã®å‹•ä½œã‚’ç´¹ä»‹ã—ã¾ã™ã€‚
ä½œæˆã•ã‚Œã‚‹ãƒªã‚¹ãƒˆã¯ microCMS å…¬å¼ã§ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ç›®æ¬¡ãƒªã‚¹ãƒˆã¨åŒã˜å½¢å¼ã¨ãªã£ã¦ã„ã¾ã™ã€‚
https://blog.microcms.io/create-table-of-contents

å…ƒã¨ãªã‚‹ HTML ãƒ‡ãƒ¼ã‚¿

```html
<h1 id="h98a35185af">What is Lorem Ipsum?</h1>
<p>
  Lorem Ipsum is simply dummy text of the printing and typesetting industry.
</p>
<h2 id="hf76e6834d0">Where does it come from?</h2>
<p>Contrary to popular belief, Lorem Ipsum is not simply random text.</p>
<h3 id="h1c03416cd7">Why do we use it?</h3>
<p>
  It is a long established fact that a reader will be distracted by the readable
  content of a page when looking at its layout.
</p>
<h4 id="rdAK6TEAQqx">Where can I get some?</h4>
```

ä½œæˆã•ã‚Œã‚‹ãƒªã‚¹ãƒˆ

```js
[
  { id: "h98a35185af", text: "What is Lorem Ipsum?", name: "h1" },
  { id: "hf76e6834d0", text: "Where does it come from?", name: "h2" },
  { id: "h1c03416cd7", text: "Why do we use it?", name: "h3" },
];
```

### createTableOfContents ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ãŸæ™‚ã®å‹•ä½œ

#### ç›®æ¬¡ã«åˆ©ç”¨ã™ã‚‹è¦‹å‡ºã—ã‚¿ã‚°ã®å¤‰æ›´

```js
createTableOfContents(content, { tags: "h2, h4" });
```

```js
[
  { id: "hf76e6834d0", text: "Where does it come from?", name: "h2" },
  { id: "rdAK6TEAQqx", text: "Where can I get some?", name: "h4" },
];
```

#### name ã‚­ãƒ¼ã®ç„¡åŠ¹åŒ–

```js
createTableOfContents(content, { dataForName: false });
```

```js
[
  { id: "h98a35185af", text: "What is Lorem Ipsum?" },
  { id: "hf76e6834d0", text: "Where does it come from?" },
  { id: "h1c03416cd7", text: "Why do we use it?" },
];
```

ã“ã¡ã‚‰ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ç¾åœ¨ã¯`tagName`ã¨`false`ã®ã¿ã§ã™ãŒã€
microCMS ã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã§è¦‹å‡ºã—ã‚¿ã‚°ã«ä½•ã‹æ„å‘³ã¥ã‘ãŒã§ãã‚‹ã‚‚ã®ãŒè¿½åŠ ã•ã‚ŒãŸã¨ãã¯
ãã¡ã‚‰ã®æŒ‡å®šã‚‚ã§ãã‚‹ã‚ˆã†ã«æ©Ÿèƒ½è¿½åŠ äºˆå®šã§ã™ã€‚

# ãŠã‚ã‚Šã«

HTML ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†ã¯ Jamstack ãªã‚µã‚¤ãƒˆã‚’ä½œã‚‹æ™‚ã«åœ°å‘³ã«é¢å€’ãªå‡¦ç†ã ã£ãŸã‚Šã—ã¾ã™ã€‚
ãã®è¾ºã‚Šã‚’ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå´ã«éš è”½ã™ã‚‹ã“ã¨ã§ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚‚ã‚¹ãƒƒã‚­ãƒªã™ã‚‹ã‹ã¨æ€ã„ã¾ã™ï¼

ãœã²ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ï¼

# URLs

https://www.npmjs.com/package/microcms-richedit-processer
https://github.com/dc7290/microcms-richedit-processer#readme

# ä½™è«‡ ã¡ã‚‡ã£ã¨ã—ãŸå¾Œæ‚”

ä»Šå›ä½œã£ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®åå‰ãŒ

`microcms-richedit-processer`

ãªã®ã§ã™ãŒã€ã‚‚ã—ã‹ã™ã‚‹ã¨æ„å‘³çš„ã«ã¯
processer ã§ã¯ãªã processor ã‹ã‚‚ã—ã‚Œãªã„ã¨æ€ã£ãŸã®ã§ã™ãƒ»ãƒ»ãƒ»

ã—ã‹ã—ã€æ°—ã¥ã„ãŸæ™‚ã«ã¯ã™ã§ã«é…ãã€
ã¾ã‚ã€æ„å‘³ã¯é€šã˜ã‚‹ã—ã„ã„ã ã‚ã†ã¨ã„ã†æ„Ÿã˜ã§ã™ã€‚
